import org.zaproxy.zap.extension.ascan.ActiveScanRule
import org.parosproxy.paros.network.HttpMessage
import org.parosproxy.paros.core.scanner.Alert

class CMSVulnerabilitiesRule extends ActiveScanRule {
    @Override
    public void scan(HttpMessage msg, String param, String value) {
        // Placeholder for CMS specific checks, such as known exploits for WordPress, Joomla, etc.
        sendAndReceive(msg, false)
        if (msg.getResponseBody().toString().contains("wp-admin") || msg.getResponseBody().toString().contains("Joomla!")) {
            bingo(Alert.RISK_HIGH, Alert.CONFIDENCE_MEDIUM, "CMS Vulnerabilities", "Known CMS vulnerabilities detected.", msg.getRequestHeader().getURI().toString(), param, value, "CMS detected", "", msg)
        }
    }
}
